(this["webpackJsonptoy-react"]=this["webpackJsonptoy-react"]||[]).push([[0],{71:function(e,t,a){e.exports=a(83)},76:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),l=a.n(c),i=(a(76),a(40)),o=a.n(i),u=a(58),s=a(34),d=a(19),m=a(141),p=a(143),f=a(142),b=a(131),g=a(134),E=a(85),v=a(128),h=a(135),y=a(144),O=a(145),j=a(150),k=a(137),w=a(149),C=a(139),x=a(133),D=a(147),S=a(148),I=a(35),R=a(136),A=a(146),U=a(138),M=a(140),N=Object(v.a)((function(e){return{heroContent:{backgroundColor:e.palette.background.paper,padding:e.spacing(8,0,6)},heroButtons:{marginTop:e.spacing(4)},cardGrid:{paddingTop:e.spacing(8),paddingBottom:e.spacing(4)},card:{height:"100%",display:"flex",flexDirection:"column",position:"relative",borderWidth:"0.5em"},cardMedia:{paddingTop:"100%"},cardContent:{flexGrow:1},cardOverlay:{position:"absolute"}}}));function T(){var e=N(),t=Object(n.useState)([]),a=Object(d.a)(t,2),c=a[0],l=a[1],i=Object(n.useState)("Style"),m=Object(d.a)(i,2),p=m[0],f=m[1],E=Object(n.useState)(8),v=Object(d.a)(E,2),y=v[0],O=v[1],j=Object(n.useState)(y),k=Object(d.a)(j,2),w=k[0],C=k[1],D=Object(n.useState)([]),S=Object(d.a)(D,2),A=S[0],U=S[1],M=Object(n.useState)(!1),T=Object(d.a)(M,2),_=T[0],q=T[1],W=Object(n.useState)(!1),J=Object(d.a)(W,2),P=J[0],V=J[1],$=function(){if(P&&console.warn("Nested fetch"),C(y),l([]),0!==A.length){var e,t=new FormData,a=Object(s.a)(A);try{for(a.s();!(e=a.n()).done;){var n=e.value;n.aid?t.append("query_aid",n.aid):n.file?t.append("query_file",n.file):n.url&&t.append("query_url",n.url)}}catch(c){a.e(c)}finally{a.f()}t.append("searchengine",p),t.append("resultcount",y);var r=new XMLHttpRequest;r.open("POST","https://blockchain.surrey.ac.uk/deepdiscovery/api/upload",!0),r.onload=function(){l(JSON.parse(this.responseText).filter((function(e){return null!=e.collection&&null!=L(e.collection).name}))),V(!1)},V(!0),r.send(t)}};Object(n.useEffect)((function(){_||$()}),[A,p]),Object(n.useEffect)((function(){_||U([])}),[_]);var H=function(){var e=Object(u.a)(o.a.mark((function e(t){var a,n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=_?A.slice():[],n=Object(s.a)(t),e.prev=2,c=o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.value,n={key:a.length,file:t,title:t.name},e.next=4,new Promise((function(e){var a=new FileReader;a.onload=function(t){e(t.target.result)},a.readAsDataURL(t)}));case 4:n.url=e.sent,a.push(n);case 6:case"end":return e.stop()}}),e)})),n.s();case 5:if((r=n.n()).done){e.next=9;break}return e.delegateYield(c(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),n.e(e.t1);case 14:return e.prev=14,n.f(),e.finish(14);case 17:U(a);case 18:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null),r.a.createElement("main",null,r.a.createElement(x.a,{backend:I.a},r.a.createElement("div",{className:e.heroContent},r.a.createElement(g.a,{container:!0,spacing:3,justify:"space-between"},r.a.createElement(g.a,{item:!0,xs:!0},r.a.createElement(B,{onFileDrop:function(e){return H(e)},onURLDrop:function(e){return function(e){var t,a=_?A.slice():[],n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;a.push({key:a.length,url:r,title:r.substring(r.lastIndexOf("/")+1)})}}catch(c){n.e(c)}finally{n.f()}U(a)}(e)},onAssetDrop:function(e){return function(e){var t=_?A.slice():[],a=Object.assign({},e);delete a.distance,a.key=t.length,t.push(a),U(t)}(e)},inputCards:A,showDropCard:0===A.length||_,disabled:P})),r.a.createElement(g.a,{item:!0,xs:3},r.a.createElement(F,{className:e.heroContent,restoreCount:function(){O(w)},resultCount:y,onResultCountUpdate:O,engine:p,onEngineUpdate:f,forceUpdate:$,multiInput:_,setMultiInput:q,disabled:P})))),r.a.createElement(h.a,{className:e.cardGrid,maxWidth:"md"},P?r.a.createElement(R.a,null):null,r.a.createElement(g.a,{container:!0,spacing:4},c.map((function(e){return r.a.createElement(g.a,{item:!0,key:e.aid,xs:6,sm:6,md:3},r.a.createElement(G,{card:e}))})))))))}function B(e){var t=e.onFileDrop,a=e.onURLDrop,n=e.onAssetDrop,c=e.inputCards,l=e.showDropCard,i=e.disabled,o=Object(D.a)({accept:[I.b.FILE,I.b.URL,"CARD"],drop:function(e,r){if(r.getItemType()===I.b.FILE){var c,l=r.getItem().files,i=Object(s.a)(l);try{for(i.s();!(c=i.n()).done;){var o=c.value;if("image/jpeg"!==o.type&&"image/png"!==o.type)return}}catch(b){i.e(b)}finally{i.f()}t(l)}else if(r.getItemType()===I.b.URL){var u,d=r.getItem().urls,m=Object(s.a)(d);try{for(m.s();!(u=m.n()).done;){var p=u.value,f=p.substring(p.lastIndexOf(".")+1);if("jpg"!==f&&"jpeg"!==f&&"png"!==f)return}}catch(b){m.e(b)}finally{m.f()}a(d)}else n(e.card)}}),u=Object(d.a)(o,2)[1],m=null;return l&&(m=r.a.createElement(g.a,{item:!0,key:-1,xs:6,sm:6,md:3},r.a.createElement(G,{card:{url:"//:0"}}))),r.a.createElement("div",{ref:i?null:u},r.a.createElement(g.a,{container:!0,spacing:4},c.map((function(e){return r.a.createElement(g.a,{item:!0,key:e.key,xs:6,sm:6,md:3},r.a.createElement(G,{card:e}))})),m))}function L(e){if(null==e)return null;var t={id:e};return"RGBE"===e?(t.name="Royal Botanic Garden Edinburgh",t.color="darkgreen"):"MODA"===e?(t.name="The Museum of Domestic Design and Architeture",t.color="blue"):"TNA"===e.slice(0,3)?(t.name="The National Archives",t.color="gray"):"VA"===e.slice(0,2)?(t.name="Victoria & Albert Museum",t.color="red"):(t.name=null,t.color="whitesmoke"),t}function F(e){var t=e.resultCount,a=e.onResultCountUpdate,n=e.restoreCount,c=e.engine,l=e.onEngineUpdate,i=e.forceUpdate,o=e.multiInput,u=e.setMultiInput,s=e.disabled;return r.a.createElement(g.a,{container:!0,direction:"column","align-items":"space-between",spacing:3},r.a.createElement("fieldset",{disabled:s},r.a.createElement(g.a,{item:!0},r.a.createElement(y.a,{label:"Results",name:"resultCount",value:t,onChange:function(e){var t=e.target.value;/^\d{0,3}$/.test(t)&&a(t)},onBlur:n,onKeyPress:function(e){"Enter"===e.key&&(0===parseInt(t,10)||""===t?n():i())}})),r.a.createElement(g.a,{item:!0},r.a.createElement(w.a,{component:"fieldset"},r.a.createElement(k.a,{id:"engine_legend",component:"legend"},"Search Engine"),r.a.createElement(j.a,{name:"engine",value:c,onChange:function(e){return l(e.target.value)},"aria-labelledby":"engine_legend"},r.a.createElement(C.a,{value:"Style",control:r.a.createElement(O.a,null),label:"Style"}),r.a.createElement(C.a,{value:"Semantic",control:r.a.createElement(O.a,null),label:"Semantic"})))),r.a.createElement(g.a,{item:!0},r.a.createElement(U.a,{row:!0},r.a.createElement(C.a,{control:r.a.createElement(A.a,{checked:o,onChange:function(e){return u(e.target.checked)}}),label:"Multiple Inputs"}),r.a.createElement(M.a,{variant:"contained",disabled:!o,onClick:i},"Submit")))))}function G(e){var t=e.card,a=N(),n=Object(S.a)({item:{type:"CARD",card:t}}),c=Object(d.a)(n,2)[1],l="Black",i="",o=L(t.collection);null!==o&&(l=o.color,i=null==o.name?o.id:o.name);var u=null;t.aid&&(u=r.a.createElement(E.a,{variant:"caption"},"Asset ID: ",t.aid,t.distance?r.a.createElement("br",null):null));var s=null;t.distance&&(s=r.a.createElement(E.a,{variant:"caption"},"Distance: ",t.distance));var b=null;return t.title&&(b=r.a.createElement(E.a,{variant:"caption"},t.title)),r.a.createElement(m.a,{ref:c,className:a.card,variant:"outlined",style:{borderColor:l}},r.a.createElement("a",{href:t.url},r.a.createElement(f.a,{className:a.cardMedia,image:t.url,title:t.title})),r.a.createElement(p.a,{className:a.cardContent},r.a.createElement(E.a,{variant:"caption"},r.a.createElement("b",null,i)),r.a.createElement("br",null),u,s,b))}a(82);var _=function(){return r.a.createElement(T,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[71,1,2]]]);
//# sourceMappingURL=main.02b5e48e.chunk.js.map